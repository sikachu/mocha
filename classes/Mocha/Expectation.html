<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html lang='en'>
  <head>
    <title>Mocha::Expectation</title>
    <meta content='text/html; charset=UTF-8' http-equiv='Content-Type'>
    <link href='../../css/style.css' media='screen' rel='stylesheet' type='text/css'>
    <script type='text/javascript'>
      //<![CDATA[
        function popupCode(url) {
          window.open(url, "Code", "resizable=yes,scrollbars=yes,toolbar=no,status=no,height=150,width=400")
        }
        
        function toggleCode(id) {
          var code = document.getElementById(id)
        
          code.style.display = code.style.display != 'block' ? 'block' : 'none'
          return true
        }
        
        // Make codeblocks hidden by default
        document.writeln('<' + 'style type="text/css">.method .source pre { display: none }<\/style>')
      //]]>
    </script>
  </head>
  <body class='page'>
    <div class='class' id='wrapper'>
      <div class='header'>
        <h1 class='name'>
          <span class='type'>class</span>
          Mocha::Expectation
        </h1>
        <ol class='paths'>
          <li>
            <a target="docwin" href="../../files/lib/mocha/expectation_rb.html">lib/mocha/expectation.rb</a>
          </li>
        </ol>
        <div class='parent'>
          Parent:
          <strong><a target="docwin" href="../Mocha.html">Mocha</a></strong>
        </div>
      </div>
      <div id='content'>
        <div id='text'>
          <div id='description'>
            
            <p>Methods on expectations returned from <a
            href="Mock.html#method-i-expects">Mocha::Mock#expects</a>, <a
            href="Mock.html#method-i-stubs">Mocha::Mock#stubs</a>, <a
            href="ObjectMethods.html#method-i-expects">Mocha::ObjectMethods#expects</a>
            and <a
            href="ObjectMethods.html#method-i-stubs">Mocha::ObjectMethods#stubs</a>.</p>
          </div>
          <div id='method-list'>
            <h2>Methods</h2>
            <h3>Public Instance</h3>
            <ol>
              <li><a target="docwin" href="#method-i-at_least">at_least</a></li>
              <li><a target="docwin" href="#method-i-at_least_once">at_least_once</a></li>
              <li><a target="docwin" href="#method-i-at_most">at_most</a></li>
              <li><a target="docwin" href="#method-i-at_most_once">at_most_once</a></li>
              <li><a target="docwin" href="#method-i-in_sequence">in_sequence</a></li>
              <li><a target="docwin" href="#method-i-multiple_yields">multiple_yields</a></li>
              <li><a target="docwin" href="#method-i-never">never</a></li>
              <li><a target="docwin" href="#method-i-once">once</a></li>
              <li><a target="docwin" href="#method-i-raises">raises</a></li>
              <li><a target="docwin" href="#method-i-returns">returns</a></li>
              <li><a target="docwin" href="#method-i-then">then</a></li>
              <li><a target="docwin" href="#method-i-throws">throws</a></li>
              <li><a target="docwin" href="#method-i-times">times</a></li>
              <li><a target="docwin" href="#method-i-twice">twice</a></li>
              <li><a target="docwin" href="#method-i-when">when</a></li>
              <li><a target="docwin" href="#method-i-with">with</a></li>
              <li><a target="docwin" href="#method-i-yields">yields</a></li>
            </ol>
          </div>
          <div id='context'>
          </div>
          <div id='section'>
            <div id='methods'>
              <h2>Public Instance methods</h2>
              <div class='method public-instance' id='method-method-i-at_least'>
                <a name='method-i-at_least'></a>
                <div class='synopsis'>
                  <span class='name'>
                    <div>at_least(minimum_number_of_times) -> expectation</div>
                  </span>
                </div>
                <div class='description'>
                  
                  <p>Modifies expectation so that the expected method must be called at least a
                  <code>minimum_number_of_times</code>.</p>
                  
                  <pre class="ruby"><span class="ruby-identifier">object</span> = <span class="ruby-identifier">mock</span>()&#x000A;<span class="ruby-identifier">object</span>.<span class="ruby-identifier">expects</span>(:<span class="ruby-identifier">expected_method</span>).<span class="ruby-identifier">at_least</span>(<span class="ruby-value">2</span>)&#x000A;<span class="ruby-value">3</span>.<span class="ruby-identifier">times</span> { <span class="ruby-identifier">object</span>.<span class="ruby-identifier">expected_method</span> }&#x000A;<span class="ruby-comment"># =&gt; verify succeeds</span>&#x000A;&#x000A;<span class="ruby-identifier">object</span> = <span class="ruby-identifier">mock</span>()&#x000A;<span class="ruby-identifier">object</span>.<span class="ruby-identifier">expects</span>(:<span class="ruby-identifier">expected_method</span>).<span class="ruby-identifier">at_least</span>(<span class="ruby-value">2</span>)&#x000A;<span class="ruby-identifier">object</span>.<span class="ruby-identifier">expected_method</span>&#x000A;<span class="ruby-comment"># =&gt; verify fails</span></pre>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-at_least-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-at_least-source'><span class="ruby-comment"># File lib/mocha/expectation.rb, line 123</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">at_least</span>(<span class="ruby-identifier">minimum_number_of_times</span>)&#x000A;  <span class="ruby-ivar">@cardinality</span> = <span class="ruby-constant">Cardinality</span>.<span class="ruby-identifier">at_least</span>(<span class="ruby-identifier">minimum_number_of_times</span>)&#x000A;  <span class="ruby-keyword">self</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-at_least_once'>
                <a name='method-i-at_least_once'></a>
                <div class='synopsis'>
                  <span class='name'>
                    <div>at_least_once() -> expectation</div>
                  </span>
                </div>
                <div class='description'>
                  
                  <p>Modifies expectation so that the expected method must be called at least
                  once.</p>
                  
                  <pre class="ruby"><span class="ruby-identifier">object</span> = <span class="ruby-identifier">mock</span>()&#x000A;<span class="ruby-identifier">object</span>.<span class="ruby-identifier">expects</span>(:<span class="ruby-identifier">expected_method</span>).<span class="ruby-identifier">at_least_once</span>&#x000A;<span class="ruby-identifier">object</span>.<span class="ruby-identifier">expected_method</span>&#x000A;<span class="ruby-comment"># =&gt; verify succeeds</span>&#x000A;&#x000A;<span class="ruby-identifier">object</span> = <span class="ruby-identifier">mock</span>()&#x000A;<span class="ruby-identifier">object</span>.<span class="ruby-identifier">expects</span>(:<span class="ruby-identifier">expected_method</span>).<span class="ruby-identifier">at_least_once</span>&#x000A;<span class="ruby-comment"># =&gt; verify fails</span></pre>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-at_least_once-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-at_least_once-source'><span class="ruby-comment"># File lib/mocha/expectation.rb, line 139</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">at_least_once</span>&#x000A;  <span class="ruby-identifier">at_least</span>(<span class="ruby-value">1</span>)&#x000A;  <span class="ruby-keyword">self</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-at_most'>
                <a name='method-i-at_most'></a>
                <div class='synopsis'>
                  <span class='name'>
                    <div>at_most(maximum_number_of_times) -> expectation</div>
                  </span>
                </div>
                <div class='description'>
                  
                  <p>Modifies expectation so that the expected method must be called at most a
                  <code>maximum_number_of_times</code>.</p>
                  
                  <pre class="ruby"><span class="ruby-identifier">object</span> = <span class="ruby-identifier">mock</span>()&#x000A;<span class="ruby-identifier">object</span>.<span class="ruby-identifier">expects</span>(:<span class="ruby-identifier">expected_method</span>).<span class="ruby-identifier">at_most</span>(<span class="ruby-value">2</span>)&#x000A;<span class="ruby-value">2</span>.<span class="ruby-identifier">times</span> { <span class="ruby-identifier">object</span>.<span class="ruby-identifier">expected_method</span> }&#x000A;<span class="ruby-comment"># =&gt; verify succeeds</span>&#x000A;&#x000A;<span class="ruby-identifier">object</span> = <span class="ruby-identifier">mock</span>()&#x000A;<span class="ruby-identifier">object</span>.<span class="ruby-identifier">expects</span>(:<span class="ruby-identifier">expected_method</span>).<span class="ruby-identifier">at_most</span>(<span class="ruby-value">2</span>)&#x000A;<span class="ruby-value">3</span>.<span class="ruby-identifier">times</span> { <span class="ruby-identifier">object</span>.<span class="ruby-identifier">expected_method</span> }&#x000A;<span class="ruby-comment"># =&gt; verify fails</span></pre>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-at_most-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-at_most-source'><span class="ruby-comment"># File lib/mocha/expectation.rb, line 156</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">at_most</span>(<span class="ruby-identifier">maximum_number_of_times</span>)&#x000A;  <span class="ruby-ivar">@cardinality</span> = <span class="ruby-constant">Cardinality</span>.<span class="ruby-identifier">at_most</span>(<span class="ruby-identifier">maximum_number_of_times</span>)&#x000A;  <span class="ruby-keyword">self</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-at_most_once'>
                <a name='method-i-at_most_once'></a>
                <div class='synopsis'>
                  <span class='name'>
                    <div>at_most_once() -> expectation</div>
                  </span>
                </div>
                <div class='description'>
                  
                  <p>Modifies expectation so that the expected method must be called at most
                  once.</p>
                  
                  <pre class="ruby"><span class="ruby-identifier">object</span> = <span class="ruby-identifier">mock</span>()&#x000A;<span class="ruby-identifier">object</span>.<span class="ruby-identifier">expects</span>(:<span class="ruby-identifier">expected_method</span>).<span class="ruby-identifier">at_most_once</span>&#x000A;<span class="ruby-identifier">object</span>.<span class="ruby-identifier">expected_method</span>&#x000A;<span class="ruby-comment"># =&gt; verify succeeds</span>&#x000A;&#x000A;<span class="ruby-identifier">object</span> = <span class="ruby-identifier">mock</span>()&#x000A;<span class="ruby-identifier">object</span>.<span class="ruby-identifier">expects</span>(:<span class="ruby-identifier">expected_method</span>).<span class="ruby-identifier">at_most_once</span>&#x000A;<span class="ruby-value">2</span>.<span class="ruby-identifier">times</span> { <span class="ruby-identifier">object</span>.<span class="ruby-identifier">expected_method</span> }&#x000A;<span class="ruby-comment"># =&gt; verify fails</span></pre>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-at_most_once-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-at_most_once-source'><span class="ruby-comment"># File lib/mocha/expectation.rb, line 173</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">at_most_once</span>()&#x000A;  <span class="ruby-identifier">at_most</span>(<span class="ruby-value">1</span>)&#x000A;  <span class="ruby-keyword">self</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-in_sequence'>
                <a name='method-i-in_sequence'></a>
                <div class='synopsis'>
                  <span class='name'>
                    <div>in_sequence(*sequences) -> expectation</div>
                  </span>
                </div>
                <div class='description'>
                  
                  <p>Constrains this expectation so that it must be invoked at the current point
                  in the sequence.</p>
                  
                  <p>To expect a sequence of invocations, write the expectations in order and
                  add the <a
                  href="Expectation.html#method-i-in_sequence">#in_sequence</a>(sequence)
                  clause to each one.</p>
                  
                  <p>Expectations in a sequence can have any invocation count.</p>
                  
                  <p>If an expectation in a sequence is stubbed, rather than expected, it can be
                  skipped in the sequence.</p>
                  
                  <p>See also <a href="API.html#method-i-sequence">Mocha::API#sequence</a>.</p>
                  
                  <pre>breakfast = sequence('breakfast')&#x000A;egg = mock('egg')&#x000A;egg.expects(:crack).in_sequence(breakfast)&#x000A;egg.expects(:fry).in_sequence(breakfast)&#x000A;egg.expects(:eat).in_sequence(breakfast)</pre>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-in_sequence-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-in_sequence-source'><span class="ruby-comment"># File lib/mocha/expectation.rb, line 410</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">in_sequence</span>(*<span class="ruby-identifier">sequences</span>)&#x000A;  <span class="ruby-identifier">sequences</span>.<span class="ruby-identifier">each</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">sequence</span><span class="ruby-operator">|</span> <span class="ruby-identifier">add_in_sequence_ordering_constraint</span>(<span class="ruby-identifier">sequence</span>) }&#x000A;  <span class="ruby-keyword">self</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-multiple_yields'>
                <a name='method-i-multiple_yields'></a>
                <div class='synopsis'>
                  <span class='name'>
                    <div>multiple_yields(*parameter_groups) -> expectation</div>
                  </span>
                </div>
                <div class='description'>
                  
                  <p>Modifies expectation so that when the expected method is called, it yields
                  multiple times per invocation with the specified
                  <code>parameter_groups</code>.</p>
                  
                  <p>Note that each <code>parameter_group</code> should be an Array representing
                  the parameters to be passed to the block for a single yield. In the
                  following example when the expected_method is called, the stub will invoke
                  the block twice, the first time it passes ‘result_1’, ‘result_2’ as
                  the parameters, and the second time it passes ‘result_3’ as the
                  parameters.</p>
                  
                  <pre class="ruby"><span class="ruby-identifier">object</span> = <span class="ruby-identifier">mock</span>()&#x000A;<span class="ruby-identifier">object</span>.<span class="ruby-identifier">expects</span>(:<span class="ruby-identifier">expected_method</span>).<span class="ruby-identifier">multiple_yields</span>([<span class="ruby-string">'result_1'</span>, <span class="ruby-string">'result_2'</span>], [<span class="ruby-string">'result_3'</span>])&#x000A;<span class="ruby-identifier">yielded_values</span> = []&#x000A;<span class="ruby-identifier">object</span>.<span class="ruby-identifier">expected_method</span> { <span class="ruby-operator">|</span>*<span class="ruby-identifier">values</span><span class="ruby-operator">|</span> <span class="ruby-identifier">yielded_values</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">values</span> }&#x000A;<span class="ruby-identifier">yielded_values</span> <span class="ruby-comment"># =&gt; [['result_1', 'result_2'], ['result_3]]</span></pre>
                  
                  <p>May be called multiple times on the same expectation for consecutive
                  invocations. Also see <a href="Expectation.html#method-i-then">#then</a>.</p>
                  
                  <pre class="ruby"><span class="ruby-identifier">object</span> = <span class="ruby-identifier">mock</span>()&#x000A;<span class="ruby-identifier">object</span>.<span class="ruby-identifier">stubs</span>(:<span class="ruby-identifier">expected_method</span>).<span class="ruby-identifier">multiple_yields</span>([<span class="ruby-value">1</span>, <span class="ruby-value">2</span>], [<span class="ruby-value">3</span>]).<span class="ruby-identifier">then</span>.<span class="ruby-identifier">multiple_yields</span>([<span class="ruby-value">4</span>], [<span class="ruby-value">5</span>, <span class="ruby-value">6</span>])&#x000A;<span class="ruby-identifier">yielded_values_from_first_invocation</span> = []&#x000A;<span class="ruby-identifier">yielded_values_from_second_invocation</span> = []&#x000A;<span class="ruby-identifier">object</span>.<span class="ruby-identifier">expected_method</span> { <span class="ruby-operator">|</span>*<span class="ruby-identifier">values</span><span class="ruby-operator">|</span> <span class="ruby-identifier">yielded_values_from_first_invocation</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">values</span> } <span class="ruby-comment"># first invocation</span>&#x000A;<span class="ruby-identifier">object</span>.<span class="ruby-identifier">expected_method</span> { <span class="ruby-operator">|</span>*<span class="ruby-identifier">values</span><span class="ruby-operator">|</span> <span class="ruby-identifier">yielded_values_from_second_invocation</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">values</span> } <span class="ruby-comment"># second invocation</span>&#x000A;<span class="ruby-identifier">yielded_values_from_first_invocation</span> <span class="ruby-comment"># =&gt; [[1, 2], [3]]</span>&#x000A;<span class="ruby-identifier">yielded_values_from_second_invocation</span> <span class="ruby-comment"># =&gt; [[4], [5, 6]]</span></pre>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-multiple_yields-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-multiple_yields-source'><span class="ruby-comment"># File lib/mocha/expectation.rb, line 250</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">multiple_yields</span>(*<span class="ruby-identifier">parameter_groups</span>)&#x000A;  <span class="ruby-ivar">@yield_parameters</span>.<span class="ruby-identifier">multiple_add</span>(*<span class="ruby-identifier">parameter_groups</span>)&#x000A;  <span class="ruby-keyword">self</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-never'>
                <a name='method-i-never'></a>
                <div class='synopsis'>
                  <span class='name'>
                    <div>never() -> expectation</div>
                  </span>
                </div>
                <div class='description'>
                  
                  <p>Modifies expectation so that the expected method must never be called.</p>
                  
                  <pre class="ruby"><span class="ruby-identifier">object</span> = <span class="ruby-identifier">mock</span>()&#x000A;<span class="ruby-identifier">object</span>.<span class="ruby-identifier">expects</span>(:<span class="ruby-identifier">expected_method</span>).<span class="ruby-identifier">never</span>&#x000A;<span class="ruby-identifier">object</span>.<span class="ruby-identifier">expected_method</span>&#x000A;<span class="ruby-comment"># =&gt; verify fails</span>&#x000A;&#x000A;<span class="ruby-identifier">object</span> = <span class="ruby-identifier">mock</span>()&#x000A;<span class="ruby-identifier">object</span>.<span class="ruby-identifier">expects</span>(:<span class="ruby-identifier">expected_method</span>).<span class="ruby-identifier">never</span>&#x000A;<span class="ruby-comment"># =&gt; verify succeeds</span></pre>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-never-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-never-source'><span class="ruby-comment"># File lib/mocha/expectation.rb, line 106</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">never</span>&#x000A;  <span class="ruby-ivar">@cardinality</span> = <span class="ruby-constant">Cardinality</span>.<span class="ruby-identifier">exactly</span>(<span class="ruby-value">0</span>)&#x000A;  <span class="ruby-keyword">self</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-once'>
                <a name='method-i-once'></a>
                <div class='synopsis'>
                  <span class='name'>
                    <div>once() -> expectation</div>
                  </span>
                </div>
                <div class='description'>
                  
                  <p>Modifies expectation so that the expected method must be called exactly
                  once. Note that this is the default behaviour for an expectation, but you
                  may wish to use it for clarity/emphasis.</p>
                  
                  <pre class="ruby"><span class="ruby-identifier">object</span> = <span class="ruby-identifier">mock</span>()&#x000A;<span class="ruby-identifier">object</span>.<span class="ruby-identifier">expects</span>(:<span class="ruby-identifier">expected_method</span>).<span class="ruby-identifier">once</span>&#x000A;<span class="ruby-identifier">object</span>.<span class="ruby-identifier">expected_method</span>&#x000A;<span class="ruby-comment"># =&gt; verify succeeds</span>&#x000A;&#x000A;<span class="ruby-identifier">object</span> = <span class="ruby-identifier">mock</span>()&#x000A;<span class="ruby-identifier">object</span>.<span class="ruby-identifier">expects</span>(:<span class="ruby-identifier">expected_method</span>).<span class="ruby-identifier">once</span>&#x000A;<span class="ruby-identifier">object</span>.<span class="ruby-identifier">expected_method</span>&#x000A;<span class="ruby-identifier">object</span>.<span class="ruby-identifier">expected_method</span>&#x000A;<span class="ruby-comment"># =&gt; verify fails</span>&#x000A;&#x000A;<span class="ruby-identifier">object</span> = <span class="ruby-identifier">mock</span>()&#x000A;<span class="ruby-identifier">object</span>.<span class="ruby-identifier">expects</span>(:<span class="ruby-identifier">expected_method</span>).<span class="ruby-identifier">once</span>&#x000A;<span class="ruby-comment"># =&gt; verify fails</span></pre>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-once-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-once-source'><span class="ruby-comment"># File lib/mocha/expectation.rb, line 90</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">once</span>&#x000A;  <span class="ruby-ivar">@cardinality</span> = <span class="ruby-constant">Cardinality</span>.<span class="ruby-identifier">exactly</span>(<span class="ruby-value">1</span>)&#x000A;  <span class="ruby-keyword">self</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-raises'>
                <a name='method-i-raises'></a>
                <div class='synopsis'>
                  <span class='name'>
                    <div>raises(exception = RuntimeError, message = nil) -> expectation</div>
                  </span>
                </div>
                <div class='description'>
                  
                  <p>Modifies expectation so that when the expected method is called, it raises
                  the specified <code>exception</code> with the specified
                  <code>message</code> i.e. calls Kernel#raise(exception, message).</p>
                  
                  <pre class="ruby"><span class="ruby-identifier">object</span> = <span class="ruby-identifier">stub</span>()&#x000A;<span class="ruby-identifier">object</span>.<span class="ruby-identifier">stubs</span>(:<span class="ruby-identifier">expected_method</span>).<span class="ruby-identifier">raises</span>(<span class="ruby-constant">Exception</span>, <span class="ruby-string">'message'</span>)&#x000A;<span class="ruby-identifier">object</span>.<span class="ruby-identifier">expected_method</span> <span class="ruby-comment"># =&gt; raises exception of class Exception and with message 'message'</span></pre>
                  
                  <p>Note that if you have a custom exception class with extra constructor
                  parameters, you can pass in an instance of the exception (just as you can
                  for Kernel#raise).</p>
                  
                  <pre class="ruby"><span class="ruby-identifier">object</span> = <span class="ruby-identifier">stub</span>()&#x000A;<span class="ruby-identifier">object</span>.<span class="ruby-identifier">stubs</span>(:<span class="ruby-identifier">expected_method</span>).<span class="ruby-identifier">raises</span>(<span class="ruby-constant">MyException</span>.<span class="ruby-identifier">new</span>(<span class="ruby-string">'message'</span>, <span class="ruby-value">1</span>, <span class="ruby-value">2</span>, <span class="ruby-value">3</span>))&#x000A;<span class="ruby-identifier">object</span>.<span class="ruby-identifier">expected_method</span> <span class="ruby-comment"># =&gt; raises the specified instance of MyException</span></pre>
                  
                  <p>May be called multiple times on the same expectation. Also see <a
                  href="Expectation.html#method-i-then">#then</a>.</p>
                  
                  <pre class="ruby"><span class="ruby-identifier">object</span> = <span class="ruby-identifier">stub</span>()&#x000A;<span class="ruby-identifier">object</span>.<span class="ruby-identifier">stubs</span>(:<span class="ruby-identifier">expected_method</span>).<span class="ruby-identifier">raises</span>(<span class="ruby-constant">Exception1</span>).<span class="ruby-identifier">then</span>.<span class="ruby-identifier">raises</span>(<span class="ruby-constant">Exception2</span>)&#x000A;<span class="ruby-identifier">object</span>.<span class="ruby-identifier">expected_method</span> <span class="ruby-comment"># =&gt; raises exception of class Exception1</span>&#x000A;<span class="ruby-identifier">object</span>.<span class="ruby-identifier">expected_method</span> <span class="ruby-comment"># =&gt; raises exception of class Exception2</span></pre>
                  
                  <p>May be called in conjunction with <a
                  href="Expectation.html#method-i-returns">#returns</a> on the same
                  expectation.</p>
                  
                  <pre class="ruby"><span class="ruby-identifier">object</span> = <span class="ruby-identifier">stub</span>()&#x000A;<span class="ruby-identifier">object</span>.<span class="ruby-identifier">stubs</span>(:<span class="ruby-identifier">expected_method</span>).<span class="ruby-identifier">raises</span>(<span class="ruby-constant">Exception</span>).<span class="ruby-identifier">then</span>.<span class="ruby-identifier">returns</span>(<span class="ruby-value">2</span>, <span class="ruby-value">3</span>)&#x000A;<span class="ruby-identifier">object</span>.<span class="ruby-identifier">expected_method</span> <span class="ruby-comment"># =&gt; raises exception of class Exception1</span>&#x000A;<span class="ruby-identifier">object</span>.<span class="ruby-identifier">expected_method</span> <span class="ruby-comment"># =&gt; 2</span>&#x000A;<span class="ruby-identifier">object</span>.<span class="ruby-identifier">expected_method</span> <span class="ruby-comment"># =&gt; 3</span></pre>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-raises-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-raises-source'><span class="ruby-comment"># File lib/mocha/expectation.rb, line 312</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">raises</span>(<span class="ruby-identifier">exception</span> = <span class="ruby-constant">RuntimeError</span>, <span class="ruby-identifier">message</span> = <span class="ruby-keyword">nil</span>)&#x000A;  <span class="ruby-ivar">@return_values</span> <span class="ruby-operator">+=</span> <span class="ruby-constant">ReturnValues</span>.<span class="ruby-identifier">new</span>(<span class="ruby-constant">ExceptionRaiser</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">exception</span>, <span class="ruby-identifier">message</span>))&#x000A;  <span class="ruby-keyword">self</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-returns'>
                <a name='method-i-returns'></a>
                <div class='synopsis'>
                  <span class='name'>
                    <div>returns(value) -> expectation</div>
                    <div>returns(*values) -> expectation</div>
                  </span>
                </div>
                <div class='description'>
                  
                  <p>Modifies expectation so that when the expected method is called, it returns
                  the specified <code>value</code>.</p>
                  
                  <pre class="ruby"><span class="ruby-identifier">object</span> = <span class="ruby-identifier">mock</span>()&#x000A;<span class="ruby-identifier">object</span>.<span class="ruby-identifier">stubs</span>(:<span class="ruby-identifier">stubbed_method</span>).<span class="ruby-identifier">returns</span>(<span class="ruby-string">'result'</span>)&#x000A;<span class="ruby-identifier">object</span>.<span class="ruby-identifier">stubbed_method</span> <span class="ruby-comment"># =&gt; 'result'</span>&#x000A;<span class="ruby-identifier">object</span>.<span class="ruby-identifier">stubbed_method</span> <span class="ruby-comment"># =&gt; 'result'</span></pre>
                  
                  <p>If multiple <code>values</code> are given, these are returned in turn on
                  consecutive calls to the method.</p>
                  
                  <pre class="ruby"><span class="ruby-identifier">object</span> = <span class="ruby-identifier">mock</span>()&#x000A;<span class="ruby-identifier">object</span>.<span class="ruby-identifier">stubs</span>(:<span class="ruby-identifier">stubbed_method</span>).<span class="ruby-identifier">returns</span>(<span class="ruby-value">1</span>, <span class="ruby-value">2</span>)&#x000A;<span class="ruby-identifier">object</span>.<span class="ruby-identifier">stubbed_method</span> <span class="ruby-comment"># =&gt; 1</span>&#x000A;<span class="ruby-identifier">object</span>.<span class="ruby-identifier">stubbed_method</span> <span class="ruby-comment"># =&gt; 2</span></pre>
                  
                  <p>May be called multiple times on the same expectation. Also see <a
                  href="Expectation.html#method-i-then">#then</a>.</p>
                  
                  <pre class="ruby"><span class="ruby-identifier">object</span> = <span class="ruby-identifier">mock</span>()&#x000A;<span class="ruby-identifier">object</span>.<span class="ruby-identifier">stubs</span>(:<span class="ruby-identifier">expected_method</span>).<span class="ruby-identifier">returns</span>(<span class="ruby-value">1</span>, <span class="ruby-value">2</span>).<span class="ruby-identifier">then</span>.<span class="ruby-identifier">returns</span>(<span class="ruby-value">3</span>)&#x000A;<span class="ruby-identifier">object</span>.<span class="ruby-identifier">expected_method</span> <span class="ruby-comment"># =&gt; 1</span>&#x000A;<span class="ruby-identifier">object</span>.<span class="ruby-identifier">expected_method</span> <span class="ruby-comment"># =&gt; 2</span>&#x000A;<span class="ruby-identifier">object</span>.<span class="ruby-identifier">expected_method</span> <span class="ruby-comment"># =&gt; 3</span></pre>
                  
                  <p>May be called in conjunction with <a
                  href="Expectation.html#method-i-raises">#raises</a> on the same
                  expectation.</p>
                  
                  <pre class="ruby"><span class="ruby-identifier">object</span> = <span class="ruby-identifier">mock</span>()&#x000A;<span class="ruby-identifier">object</span>.<span class="ruby-identifier">stubs</span>(:<span class="ruby-identifier">expected_method</span>).<span class="ruby-identifier">returns</span>(<span class="ruby-value">1</span>, <span class="ruby-value">2</span>).<span class="ruby-identifier">then</span>.<span class="ruby-identifier">raises</span>(<span class="ruby-constant">Exception</span>)&#x000A;<span class="ruby-identifier">object</span>.<span class="ruby-identifier">expected_method</span> <span class="ruby-comment"># =&gt; 1</span>&#x000A;<span class="ruby-identifier">object</span>.<span class="ruby-identifier">expected_method</span> <span class="ruby-comment"># =&gt; 2</span>&#x000A;<span class="ruby-identifier">object</span>.<span class="ruby-identifier">expected_method</span> <span class="ruby-comment"># =&gt; raises exception of class Exception1</span></pre>
                  
                  <p>Note that in Ruby a method returning multiple values is exactly equivalent
                  to a method returning an Array of those values.</p>
                  
                  <pre class="ruby"><span class="ruby-identifier">object</span> = <span class="ruby-identifier">mock</span>()&#x000A;<span class="ruby-identifier">object</span>.<span class="ruby-identifier">stubs</span>(:<span class="ruby-identifier">expected_method</span>).<span class="ruby-identifier">returns</span>([<span class="ruby-value">1</span>, <span class="ruby-value">2</span>])&#x000A;<span class="ruby-identifier">x</span>, <span class="ruby-identifier">y</span> = <span class="ruby-identifier">object</span>.<span class="ruby-identifier">expected_method</span>&#x000A;<span class="ruby-identifier">x</span> <span class="ruby-comment"># =&gt; 1</span>&#x000A;<span class="ruby-identifier">y</span> <span class="ruby-comment"># =&gt; 2</span></pre>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-returns-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-returns-source'><span class="ruby-comment"># File lib/mocha/expectation.rb, line 286</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">returns</span>(*<span class="ruby-identifier">values</span>)&#x000A;  <span class="ruby-ivar">@return_values</span> <span class="ruby-operator">+=</span> <span class="ruby-constant">ReturnValues</span>.<span class="ruby-identifier">build</span>(*<span class="ruby-identifier">values</span>)&#x000A;  <span class="ruby-keyword">self</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-then'>
                <a name='method-i-then'></a>
                <div class='synopsis'>
                  <span class='name'>
                    <div>then() -> expectation</div>
                    <div>then(state_machine.is(state)) -> expectation</div>
                  </span>
                </div>
                <div class='description'>
                  
                  <p><code>then()</code> is used as syntactic sugar to improve readability. It
                  has no effect on state of the expectation.</p>
                  
                  <pre class="ruby"><span class="ruby-identifier">object</span> = <span class="ruby-identifier">mock</span>()&#x000A;<span class="ruby-identifier">object</span>.<span class="ruby-identifier">stubs</span>(:<span class="ruby-identifier">expected_method</span>).<span class="ruby-identifier">returns</span>(<span class="ruby-value">1</span>, <span class="ruby-value">2</span>).<span class="ruby-identifier">then</span>.<span class="ruby-identifier">raises</span>(<span class="ruby-constant">Exception</span>).<span class="ruby-identifier">then</span>.<span class="ruby-identifier">returns</span>(<span class="ruby-value">4</span>)&#x000A;<span class="ruby-identifier">object</span>.<span class="ruby-identifier">expected_method</span> <span class="ruby-comment"># =&gt; 1</span>&#x000A;<span class="ruby-identifier">object</span>.<span class="ruby-identifier">expected_method</span> <span class="ruby-comment"># =&gt; 2</span>&#x000A;<span class="ruby-identifier">object</span>.<span class="ruby-identifier">expected_method</span> <span class="ruby-comment"># =&gt; raises exception of class Exception</span>&#x000A;<span class="ruby-identifier">object</span>.<span class="ruby-identifier">expected_method</span> <span class="ruby-comment"># =&gt; 4</span></pre>
                  
                  <p><code>then(state_machine.is(state))</code> is used to change the
                  <code>state_machine</code> to the specified <code>state</code> when the
                  invocation occurs.</p>
                  
                  <p>See also <a href="API.html#method-i-states">Mocha::API#states</a>, <a
                  href="StateMachine.html">StateMachine</a> and <a
                  href="Expectation.html#method-i-when">#when</a>.</p>
                  
                  <pre>power = states('power').starts_as('off')&#x000A;radio = mock('radio')&#x000A;radio.expects(:switch_on).then(power.is('on'))&#x000A;radio.expects(:select_channel).with('BBC Radio 4').when(power.is('on'))&#x000A;radio.expects(:adjust_volume).with(+5).when(power.is('on'))&#x000A;radio.expects(:select_channel).with('BBC World Service').when(power.is('on'))&#x000A;radio.expects(:adjust_volume).with(-5).when(power.is('on'))&#x000A;radio.expects(:switch_off).then(power.is('off'))</pre>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-then-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-then-source'><span class="ruby-comment"># File lib/mocha/expectation.rb, line 366</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-keyword">then</span>(*<span class="ruby-identifier">parameters</span>)&#x000A;  <span class="ruby-keyword">if</span> <span class="ruby-identifier">parameters</span>.<span class="ruby-identifier">length</span> <span class="ruby-operator">==</span> <span class="ruby-value">1</span>&#x000A;    <span class="ruby-identifier">state</span> = <span class="ruby-identifier">parameters</span>.<span class="ruby-identifier">first</span>&#x000A;    <span class="ruby-identifier">add_side_effect</span>(<span class="ruby-constant">ChangeStateSideEffect</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">state</span>))&#x000A;  <span class="ruby-keyword">end</span>&#x000A;  <span class="ruby-keyword">self</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-throws'>
                <a name='method-i-throws'></a>
                <div class='synopsis'>
                  <span class='name'>
                    <div>throws(tag, object = nil) -> expectation</div>
                  </span>
                </div>
                <div class='description'>
                  
                  <p>Modifies expectation so that when the expected method is called, it throws
                  the specified <code>tag</code> with the specific return value
                  <code>object</code> i.e. calls Kernel#throw(tag, object).</p>
                  
                  <pre class="ruby"><span class="ruby-identifier">object</span> = <span class="ruby-identifier">stub</span>()&#x000A;<span class="ruby-identifier">object</span>.<span class="ruby-identifier">stubs</span>(:<span class="ruby-identifier">expected_method</span>).<span class="ruby-identifier">throws</span>(:<span class="ruby-identifier">done</span>)&#x000A;<span class="ruby-identifier">object</span>.<span class="ruby-identifier">expected_method</span> <span class="ruby-comment"># =&gt; throws tag :done</span></pre>
                  
                  <p>Note you can also pass in an optional return value <code>object</code>
                  (just as you can for Kernel#throw).</p>
                  
                  <pre class="ruby"><span class="ruby-identifier">object</span> = <span class="ruby-identifier">stub</span>()&#x000A;<span class="ruby-identifier">object</span>.<span class="ruby-identifier">stubs</span>(:<span class="ruby-identifier">expected_method</span>).<span class="ruby-identifier">throws</span>(:<span class="ruby-identifier">done</span>, <span class="ruby-string">'result'</span>)&#x000A;<span class="ruby-identifier">object</span>.<span class="ruby-identifier">expected_method</span> <span class="ruby-comment"># =&gt; throws tag :done and causes catch block to return 'result'</span></pre>
                  
                  <p>May be called multiple times on the same expectation. Also see <a
                  href="Expectation.html#method-i-then">#then</a>.</p>
                  
                  <pre class="ruby"><span class="ruby-identifier">object</span> = <span class="ruby-identifier">stub</span>()&#x000A;<span class="ruby-identifier">object</span>.<span class="ruby-identifier">stubs</span>(:<span class="ruby-identifier">expected_method</span>).<span class="ruby-identifier">throws</span>(:<span class="ruby-identifier">done</span>).<span class="ruby-identifier">then</span>.<span class="ruby-identifier">throws</span>(:<span class="ruby-identifier">continue</span>)&#x000A;<span class="ruby-identifier">object</span>.<span class="ruby-identifier">expected_method</span> <span class="ruby-comment"># =&gt; throws :done</span>&#x000A;<span class="ruby-identifier">object</span>.<span class="ruby-identifier">expected_method</span> <span class="ruby-comment"># =&gt; throws :continue</span></pre>
                  
                  <p>May be called in conjunction with <a
                  href="Expectation.html#method-i-returns">#returns</a> on the same
                  expectation.</p>
                  
                  <pre class="ruby"><span class="ruby-identifier">object</span> = <span class="ruby-identifier">stub</span>()&#x000A;<span class="ruby-identifier">object</span>.<span class="ruby-identifier">stubs</span>(:<span class="ruby-identifier">expected_method</span>).<span class="ruby-identifier">throws</span>(:<span class="ruby-identifier">done</span>).<span class="ruby-identifier">then</span>.<span class="ruby-identifier">returns</span>(<span class="ruby-value">2</span>, <span class="ruby-value">3</span>)&#x000A;<span class="ruby-identifier">object</span>.<span class="ruby-identifier">expected_method</span> <span class="ruby-comment"># =&gt; throws :done</span>&#x000A;<span class="ruby-identifier">object</span>.<span class="ruby-identifier">expected_method</span> <span class="ruby-comment"># =&gt; 2</span>&#x000A;<span class="ruby-identifier">object</span>.<span class="ruby-identifier">expected_method</span> <span class="ruby-comment"># =&gt; 3</span></pre>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-throws-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-throws-source'><span class="ruby-comment"># File lib/mocha/expectation.rb, line 338</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">throws</span>(<span class="ruby-identifier">tag</span>, <span class="ruby-identifier">object</span> = <span class="ruby-keyword">nil</span>)&#x000A;  <span class="ruby-ivar">@return_values</span> <span class="ruby-operator">+=</span> <span class="ruby-constant">ReturnValues</span>.<span class="ruby-identifier">new</span>(<span class="ruby-constant">Thrower</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">tag</span>, <span class="ruby-identifier">object</span>))&#x000A;  <span class="ruby-keyword">self</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-times'>
                <a name='method-i-times'></a>
                <div class='synopsis'>
                  <span class='name'>
                    <div>times(range) -> expectation</div>
                  </span>
                </div>
                <div class='description'>
                  
                  <p>Modifies expectation so that the number of calls to the expected method
                  must be within a specific <code>range</code>.</p>
                  
                  <p><code>range</code> can be specified as an exact integer or as a range of
                  integers</p>
                  
                  <pre class="ruby"><span class="ruby-identifier">object</span> = <span class="ruby-identifier">mock</span>()&#x000A;<span class="ruby-identifier">object</span>.<span class="ruby-identifier">expects</span>(:<span class="ruby-identifier">expected_method</span>).<span class="ruby-identifier">times</span>(<span class="ruby-value">3</span>)&#x000A;<span class="ruby-value">3</span>.<span class="ruby-identifier">times</span> { <span class="ruby-identifier">object</span>.<span class="ruby-identifier">expected_method</span> }&#x000A;<span class="ruby-comment"># =&gt; verify succeeds</span>&#x000A;&#x000A;<span class="ruby-identifier">object</span> = <span class="ruby-identifier">mock</span>()&#x000A;<span class="ruby-identifier">object</span>.<span class="ruby-identifier">expects</span>(:<span class="ruby-identifier">expected_method</span>).<span class="ruby-identifier">times</span>(<span class="ruby-value">3</span>)&#x000A;<span class="ruby-value">2</span>.<span class="ruby-identifier">times</span> { <span class="ruby-identifier">object</span>.<span class="ruby-identifier">expected_method</span> }&#x000A;<span class="ruby-comment"># =&gt; verify fails</span>&#x000A;&#x000A;<span class="ruby-identifier">object</span> = <span class="ruby-identifier">mock</span>()&#x000A;<span class="ruby-identifier">object</span>.<span class="ruby-identifier">expects</span>(:<span class="ruby-identifier">expected_method</span>).<span class="ruby-identifier">times</span>(<span class="ruby-value">2</span><span class="ruby-operator">..</span><span class="ruby-value">4</span>)&#x000A;<span class="ruby-value">3</span>.<span class="ruby-identifier">times</span> { <span class="ruby-identifier">object</span>.<span class="ruby-identifier">expected_method</span> }&#x000A;<span class="ruby-comment"># =&gt; verify succeeds</span>&#x000A;&#x000A;<span class="ruby-identifier">object</span> = <span class="ruby-identifier">mock</span>()&#x000A;<span class="ruby-identifier">object</span>.<span class="ruby-identifier">expects</span>(:<span class="ruby-identifier">expected_method</span>).<span class="ruby-identifier">times</span>(<span class="ruby-value">2</span><span class="ruby-operator">..</span><span class="ruby-value">4</span>)&#x000A;<span class="ruby-identifier">object</span>.<span class="ruby-identifier">expected_method</span>&#x000A;<span class="ruby-comment"># =&gt; verify fails</span></pre>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-times-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-times-source'><span class="ruby-comment"># File lib/mocha/expectation.rb, line 42</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">times</span>(<span class="ruby-identifier">range</span>)&#x000A;  <span class="ruby-ivar">@cardinality</span> = <span class="ruby-constant">Cardinality</span>.<span class="ruby-identifier">times</span>(<span class="ruby-identifier">range</span>)&#x000A;  <span class="ruby-keyword">self</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-twice'>
                <a name='method-i-twice'></a>
                <div class='synopsis'>
                  <span class='name'>
                    <div>twice() -> expectation</div>
                  </span>
                </div>
                <div class='description'>
                  
                  <p>Modifies expectation so that the expected method must be called exactly
                  twice.</p>
                  
                  <pre class="ruby"><span class="ruby-identifier">object</span> = <span class="ruby-identifier">mock</span>()&#x000A;<span class="ruby-identifier">object</span>.<span class="ruby-identifier">expects</span>(:<span class="ruby-identifier">expected_method</span>).<span class="ruby-identifier">twice</span>&#x000A;<span class="ruby-identifier">object</span>.<span class="ruby-identifier">expected_method</span>&#x000A;<span class="ruby-identifier">object</span>.<span class="ruby-identifier">expected_method</span>&#x000A;<span class="ruby-comment"># =&gt; verify succeeds</span>&#x000A;&#x000A;<span class="ruby-identifier">object</span> = <span class="ruby-identifier">mock</span>()&#x000A;<span class="ruby-identifier">object</span>.<span class="ruby-identifier">expects</span>(:<span class="ruby-identifier">expected_method</span>).<span class="ruby-identifier">twice</span>&#x000A;<span class="ruby-identifier">object</span>.<span class="ruby-identifier">expected_method</span>&#x000A;<span class="ruby-identifier">object</span>.<span class="ruby-identifier">expected_method</span>&#x000A;<span class="ruby-identifier">object</span>.<span class="ruby-identifier">expected_method</span>&#x000A;<span class="ruby-comment"># =&gt; verify fails</span>&#x000A;&#x000A;<span class="ruby-identifier">object</span> = <span class="ruby-identifier">mock</span>()&#x000A;<span class="ruby-identifier">object</span>.<span class="ruby-identifier">expects</span>(:<span class="ruby-identifier">expected_method</span>).<span class="ruby-identifier">twice</span>&#x000A;<span class="ruby-identifier">object</span>.<span class="ruby-identifier">expected_method</span>&#x000A;<span class="ruby-comment"># =&gt; verify fails</span></pre>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-twice-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-twice-source'><span class="ruby-comment"># File lib/mocha/expectation.rb, line 67</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">twice</span>&#x000A;  <span class="ruby-ivar">@cardinality</span> = <span class="ruby-constant">Cardinality</span>.<span class="ruby-identifier">exactly</span>(<span class="ruby-value">2</span>)&#x000A;  <span class="ruby-keyword">self</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-when'>
                <a name='method-i-when'></a>
                <div class='synopsis'>
                  <span class='name'>
                    <div>when(state_machine.is(state)) -> exception</div>
                  </span>
                </div>
                <div class='description'>
                  
                  <p>Constrains the expectation to occur only when the
                  <code>state_machine</code> is in the named <code>state</code>.</p>
                  
                  <p>See also <a href="API.html#method-i-states">Mocha::API#states</a>, <a
                  href="StateMachine.html#method-i-starts_as">Mocha::StateMachine#starts_as</a>
                  and <a href="Expectation.html#method-i-then">#then</a>.</p>
                  
                  <pre>power = states('power').starts_as('off')&#x000A;radio = mock('radio')&#x000A;radio.expects(:switch_on).then(power.is('on'))&#x000A;radio.expects(:select_channel).with('BBC Radio 4').when(power.is('on'))&#x000A;radio.expects(:adjust_volume).with(+5).when(power.is('on'))&#x000A;radio.expects(:select_channel).with('BBC World Service').when(power.is('on'))&#x000A;radio.expects(:adjust_volume).with(-5).when(power.is('on'))&#x000A;radio.expects(:switch_off).then(power.is('off'))</pre>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-when-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-when-source'><span class="ruby-comment"># File lib/mocha/expectation.rb, line 388</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-keyword">when</span>(<span class="ruby-identifier">state_predicate</span>)&#x000A;  <span class="ruby-identifier">add_ordering_constraint</span>(<span class="ruby-constant">InStateOrderingConstraint</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">state_predicate</span>))&#x000A;  <span class="ruby-keyword">self</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-with'>
                <a name='method-i-with'></a>
                <div class='synopsis'>
                  <span class='name'>
                    <div>with(*expected_parameters, &matching_block) -> expectation</div>
                  </span>
                </div>
                <div class='description'>
                  
                  <p>Modifies expectation so that the expected method must be called with
                  <code>expected_parameters</code>.</p>
                  
                  <pre class="ruby"><span class="ruby-identifier">object</span> = <span class="ruby-identifier">mock</span>()&#x000A;<span class="ruby-identifier">object</span>.<span class="ruby-identifier">expects</span>(:<span class="ruby-identifier">expected_method</span>).<span class="ruby-identifier">with</span>(:<span class="ruby-identifier">param1</span>, :<span class="ruby-identifier">param2</span>)&#x000A;<span class="ruby-identifier">object</span>.<span class="ruby-identifier">expected_method</span>(:<span class="ruby-identifier">param1</span>, :<span class="ruby-identifier">param2</span>)&#x000A;<span class="ruby-comment"># =&gt; verify succeeds</span>&#x000A;&#x000A;<span class="ruby-identifier">object</span> = <span class="ruby-identifier">mock</span>()&#x000A;<span class="ruby-identifier">object</span>.<span class="ruby-identifier">expects</span>(:<span class="ruby-identifier">expected_method</span>).<span class="ruby-identifier">with</span>(:<span class="ruby-identifier">param1</span>, :<span class="ruby-identifier">param2</span>)&#x000A;<span class="ruby-identifier">object</span>.<span class="ruby-identifier">expected_method</span>(:<span class="ruby-identifier">param3</span>)&#x000A;<span class="ruby-comment"># =&gt; verify fails</span></pre>
                  
                  <p>May be used with parameter matchers in <a
                  href="ParameterMatchers.html">Mocha::ParameterMatchers</a>.</p>
                  
                  <p>If a <code>matching_block</code> is given, the block is called with the
                  parameters passed to the expected method. The expectation is matched if the
                  block evaluates to <code>true</code>.</p>
                  
                  <pre class="ruby"><span class="ruby-identifier">object</span> = <span class="ruby-identifier">mock</span>()&#x000A;<span class="ruby-identifier">object</span>.<span class="ruby-identifier">expects</span>(:<span class="ruby-identifier">expected_method</span>).<span class="ruby-identifier">with</span>() { <span class="ruby-operator">|</span><span class="ruby-identifier">value</span><span class="ruby-operator">|</span> <span class="ruby-identifier">value</span> <span class="ruby-operator">%</span> <span class="ruby-value">4</span> <span class="ruby-operator">==</span> <span class="ruby-value">0</span> }&#x000A;<span class="ruby-identifier">object</span>.<span class="ruby-identifier">expected_method</span>(<span class="ruby-value">16</span>)&#x000A;<span class="ruby-comment"># =&gt; verify succeeds</span>&#x000A;&#x000A;<span class="ruby-identifier">object</span> = <span class="ruby-identifier">mock</span>()&#x000A;<span class="ruby-identifier">object</span>.<span class="ruby-identifier">expects</span>(:<span class="ruby-identifier">expected_method</span>).<span class="ruby-identifier">with</span>() { <span class="ruby-operator">|</span><span class="ruby-identifier">value</span><span class="ruby-operator">|</span> <span class="ruby-identifier">value</span> <span class="ruby-operator">%</span> <span class="ruby-value">4</span> <span class="ruby-operator">==</span> <span class="ruby-value">0</span> }&#x000A;<span class="ruby-identifier">object</span>.<span class="ruby-identifier">expected_method</span>(<span class="ruby-value">17</span>)&#x000A;<span class="ruby-comment"># =&gt; verify fails</span></pre>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-with-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-with-source'><span class="ruby-comment"># File lib/mocha/expectation.rb, line 203</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">with</span>(*<span class="ruby-identifier">expected_parameters</span>, &amp;<span class="ruby-identifier">matching_block</span>)&#x000A;  <span class="ruby-ivar">@parameters_matcher</span> = <span class="ruby-constant">ParametersMatcher</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">expected_parameters</span>, &amp;<span class="ruby-identifier">matching_block</span>)&#x000A;  <span class="ruby-keyword">self</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-yields'>
                <a name='method-i-yields'></a>
                <div class='synopsis'>
                  <span class='name'>
                    <div>yields(*parameters) -> expectation</div>
                  </span>
                </div>
                <div class='description'>
                  
                  <p>Modifies expectation so that when the expected method is called, it yields
                  with the specified <code>parameters</code>.</p>
                  
                  <pre class="ruby"><span class="ruby-identifier">object</span> = <span class="ruby-identifier">mock</span>()&#x000A;<span class="ruby-identifier">object</span>.<span class="ruby-identifier">expects</span>(:<span class="ruby-identifier">expected_method</span>).<span class="ruby-identifier">yields</span>(<span class="ruby-string">'result'</span>)&#x000A;<span class="ruby-identifier">yielded_value</span> = <span class="ruby-keyword">nil</span>&#x000A;<span class="ruby-identifier">object</span>.<span class="ruby-identifier">expected_method</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">value</span><span class="ruby-operator">|</span> <span class="ruby-identifier">yielded_value</span> = <span class="ruby-identifier">value</span> }&#x000A;<span class="ruby-identifier">yielded_value</span> <span class="ruby-comment"># =&gt; 'result'</span></pre>
                  
                  <p>May be called multiple times on the same expectation for consecutive
                  invocations. Also see <a href="Expectation.html#method-i-then">#then</a>.</p>
                  
                  <pre class="ruby"><span class="ruby-identifier">object</span> = <span class="ruby-identifier">mock</span>()&#x000A;<span class="ruby-identifier">object</span>.<span class="ruby-identifier">stubs</span>(:<span class="ruby-identifier">expected_method</span>).<span class="ruby-identifier">yields</span>(<span class="ruby-value">1</span>).<span class="ruby-identifier">then</span>.<span class="ruby-identifier">yields</span>(<span class="ruby-value">2</span>)&#x000A;<span class="ruby-identifier">yielded_values_from_first_invocation</span> = []&#x000A;<span class="ruby-identifier">yielded_values_from_second_invocation</span> = []&#x000A;<span class="ruby-identifier">object</span>.<span class="ruby-identifier">expected_method</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">value</span><span class="ruby-operator">|</span> <span class="ruby-identifier">yielded_values_from_first_invocation</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">value</span> } <span class="ruby-comment"># first invocation</span>&#x000A;<span class="ruby-identifier">object</span>.<span class="ruby-identifier">expected_method</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">value</span><span class="ruby-operator">|</span> <span class="ruby-identifier">yielded_values_from_second_invocation</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">value</span> } <span class="ruby-comment"># second invocation</span>&#x000A;<span class="ruby-identifier">yielded_values_from_first_invocation</span> <span class="ruby-comment"># =&gt; [1]</span>&#x000A;<span class="ruby-identifier">yielded_values_from_second_invocation</span> <span class="ruby-comment"># =&gt; [2]</span></pre>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-yields-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-yields-source'><span class="ruby-comment"># File lib/mocha/expectation.rb, line 225</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">yields</span>(*<span class="ruby-identifier">parameters</span>)&#x000A;  <span class="ruby-ivar">@yield_parameters</span>.<span class="ruby-identifier">add</span>(*<span class="ruby-identifier">parameters</span>)&#x000A;  <span class="ruby-keyword">self</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div id='footer-push'></div>
    </div>
    <div id='footer'>
      <a target="docwin" href="http://github.com/mislav/hanna/tree/master"><strong>Hanna</strong> RDoc template</a>
    </div>
  </body>
</html>
